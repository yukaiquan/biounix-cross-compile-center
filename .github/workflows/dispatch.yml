# 全局总控触发工作流 - 一键选择软件/版本/架构/平台编译，无需为每个软件建专属触发
# 新增软件只需在soft_name的options中添加，极简扩展
name: 全局总控 - 跨软件跨版本编译

# 仅手动触发（灵活，按需编译）
on:
  workflow_dispatch:
    inputs:
      soft_name:
        description: '选择待编译软件（与softwares/下目录名一致）'
        required: true
        type: choice
        options:
          - poplddecay
          # 新增软件只需在这里添加即可
          # - samtools
          # - bwa
          # - fastp
      soft_version:
        description: '输入软件版本（与softwares/[软件]/下目录名一致，带v）'
        required: true
        type: string
        default: 'v3.43'
      build_arch:
        description: '选择编译架构'
        required: true
        default: 'x64'
        type: choice
        options:
          - x64
          - arm64

# 调用核心复用工作流
jobs:
  global-cross-build:
    name: ${{ github.event.inputs.soft_name }}-${{ github.event.inputs.soft_version }}
    uses: ./.github/workflows/reusable/build-cross.yml
    with:
      soft_name: ${{ github.event.inputs.soft_name }}
      soft_version: ${{ github.event.inputs.soft_version }}
      build_arch: ${{ github.event.inputs.build_arch }}
    secrets: inherit
